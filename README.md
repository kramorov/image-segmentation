# Сегментация изображений
В этом разделе собраны ноутбуки с различными вариантами сетей для сегментации изображений.
Также протестированы различные подходы к подготовке подачи данных в НС.

## PSP net
За основу архитектуры взята сеть из работы HsuanKung Yang https://github.com/hellochick/PSPNet-tensorflow.

Поскольку основная целью написания моего кода было понять принцип построения **PSPnet**, оригинальная архитектура сети **PSPNet50** была немного урезана.
Код переписан под **функциональный API Tensorflow**.

Для обучения сеть использует изображения самолетов и размеченную базу.
Изображения разметки записаны в формате JPEG. Этот формат несколько размывает края разметки, поэтому было необходимо предварительно
обрабатывать изображения разметки для точного разбиения на классы.
Чтобы ускорить обучение НС, файлы с изображениями и разметкой предварительно обрабатывались, весь датасет был сохранен в формате TFRecord.
Из файла TFRecord создается датагенератор, который одновременно подает на вход НС изображение и разметку.

В качестве метрики используется собственная функция метрики, обрабатывающая пересечение двух областей.
